<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Belonging Project Gallery</title>
<style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, #1f1c2c, #928dab);
    color: #f0f0f3;
    margin: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  h1 { margin: 20px 0; }
  #uploadBtn {
    font-size: 40px;
    cursor: pointer;
    margin-bottom: 10px;
    background: #5a60f5;
    border: none;
    color: white;
    padding: 10px 20px;
    border-radius: 10px;
  }
  #gallery {
    display: flex;
    flex-wrap: wrap;
    gap: 12px;
    justify-content: center;
    max-width: 90%;
    margin-bottom: 20px;
  }
  #gallery img {
    width: 150px;
    border-radius: 8px;
    border: 2px solid #333;
  }
  #fileInput { display: none; }
</style>
</head>
<body>
<h1>Belonging Project Gallery</h1>
<button id="uploadBtn">+</button>
<p>Click here and paste your image or select a file</p>
<input type="file" id="fileInput" accept="image/*" />

<div id="gallery"></div>

<script src="/socket.io/socket.io.js"></script>
<script>
const socket = io();
const uploadBtn = document.getElementById('uploadBtn');
const fileInput = document.getElementById('fileInput');
const gallery = document.getElementById('gallery');

// Function to add an image to the gallery
function addImage(src) {
  const img = document.createElement('img');
  img.src = src;
  gallery.appendChild(img);
}

// Load previous images
socket.on('gallery history', (history) => {
  history.forEach(imgSrc => addImage(imgSrc));
});

// Upload button click triggers file input
uploadBtn.addEventListener('click', () => fileInput.click());

// Handle file selection
fileInput.addEventListener('change', (e) => {
  const file = e.target.files[0];
  if (!file) return;
  const reader = new FileReader();
  reader.onload = function(event) {
    const src = event.target.result;
    socket.emit('new image', src);
  };
  reader.readAsDataURL(file);
});

// Handle pasted images
document.addEventListener('paste', (e) => {
  const items = e.clipboardData.items;
  for (let item of items) {
    if (item.type.indexOf('image') === 0) {
      const file = item.getAsFile();
      const reader = new FileReader();
      reader.onload = function(event) {
        const src = event.target.result;
        socket.emit('new image', src);
      };
      reader.readAsDataURL(file);
    }
  }
});

// Receive new image from server
socket.on('new image', (src) => addImage(src));
</script>
</body>
</html>
